<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<title>Vue的学习笔记</title>
</head>

<body>
	<ol>
		vue如何创建新项目
		<li>vue create new-project </li>
	</ol>
	<ol>vue中如何使用less
		<li>安装less:
			npm install less
			npm install less less-loader
		</li>
		<li>在webpack.base.conf.js中添加rules对象：
			{
			test: /\.less$/,
			loader: "style-loader!css-loader!less-loader"
			}
		</li>
		<li>
			或者在webpack.base.conf.js中添加
			{
			test: /\.less$/,
			loader: ["vue-loader", "css-loader", "less-loader"]
			},
			{
			test: /\.less$/,
			loader: 'vue-loader',
			options: vueLoaderConfig
			}
		</li>
		<li>在html文件内添加 lang="less"</li>
	</ol>
	<ol>
		VScode中快捷键(vue vscode snippets)
		<li>创建基本代码框架:vbase</li>
	</ol>
	<ol>npm run dev报错的解决方式
		<li>提示下载chromedriver
			npm install chromedriver --chromedriver_cdnurl=http://cdn.npm.taobao.org/dist/chromedriver
		</li>
	</ol>
	<ol>vue中带参数跳转
		<li>
			<pre>
				getEditor(item) {
					console.log("push的参数",item)
					  this.$router.push({
						name: "editor",
						params: {
						  item: item
						}
					  });
					}
			</pre>
		</li>
		<li>
			this.data = this.$route.params.item;
		</li>
	</ol>
	<ol>vue中返回上一页
		<li>用axios的方法会改变this指向，用axios方法前，缓存this指针</li>
		<li>
			<pre>
				cancel() {
					this.$router.go(-1);
				  },
			</pre>
		</li>
	</ol>
	<ol>vue中使用省市县的选择
		<li>使用插件：https://distpicker.pigjian.com/</li>
		<li>安装
			<pre>
				npm install v-distpicker --save
			</pre>
		</li>
		<li>在main.js中导入
			<pre>
				import Distpicker from 'v-distpicker'
				Vue.component('v-distpicker', Distpicker)
			</pre>
		</li>
		<li>在需要调用的页面 js中定义引入
			<pre>
				import VDistpicker from "v-distpicker";
				components: { VDistpicker }
			</pre>
			<pre>
				<el-form-item label="地区">
					<v-distpicker
					  :province="form.province"
					  :city="form.city"
					  :area="form.county"
					  @province="onChangeProvince"
					  @city="onChangeCity"
					  @area="onChangeArea"
					></v-distpicker>
					<el-input
					  type="textarea"
					  v-model="form.area"
					  placeholder="请输入详细门牌号"
					  style="margin-top: 10px;"
					></el-input>
				  </el-form-item>
			</pre>
			<pre>绑定值
				//地区选择----省
    			onChangeProvince(data) {
    			  this.form.province = data.value;
    			},
    			//地区选择----市
    			onChangeCity(data) {
    			  this.form.city = data.value;
    			},
    			//地区选择----县
    			onChangeArea(data) {
    			  this.form.county = data.value;
    			},
			</pre>
		</li>
	</ol>
	<ol>vue中Token失效返回登陆页
		<li>
			<pre>
				/**
				 * 响应拦截
				 */
				http.interceptors.response.use(response => {
				  console.log(response)
				  if (response.data && response.data.code === 401) { // 401, token失效
				    Vue.cookie.delete('token')
				    router.options.isAddDynamicMenuRoutes = false
				    // router.push({ name: 'logIn' }) 
				    parent.location.href ='/login.html';
				  }
				  return response
				}, error => {
				  return Promise.reject(error)
				})
			</pre>
		</li>
	</ol>
	<ol>vue的键盘回车时间
		<li>如果是原生的input，使用 @keyup.enter就可以，若是使用了element-ui，
			则要加上native限制符，因为element-ui把input进行了封装，原事件就不起作用了</li>
		<li>
			<pre>
				<el-input v-model="form.name" placeholder="昵称" @keyup.enter.native="submit"></el-input>
				<el-form :model="ruleForm" status-icon :rules="rules" ref="ruleForm" label-width="100px" class="demo-ruleForm" @keyup.enter.native="submitForm('ruleForm')">
			</pre>
		</li>
		<li>
			<pre>
				<input v-model="form.name" placeholder="昵称" @keyup.enter="submit">
			</pre>
		</li>
	</ol>
	<ol>vue ElementUI弹窗
		<li>删除之前有确定弹框
			<pre>
				this.$confirm('此操作将永久删除该文件, 是否继续?', '提示', {
					confirmButtonText: '确定',
					cancelButtonText: '取消',
					type: 'warning'
				  }).then(() => {
					this.$message({
					  type: 'success',
					  message: '删除成功!'
					});
				  }).catch(() => {
					this.$message({
					  type: 'info',
					  message: '已取消删除'
					});          
				  });
			</pre>
		</li>
		<li>ElementUI 警告弹窗
			<pre>
				this.$message.error(data.msg);
			</pre>
		</li>
	</ol>
	<ol>IE不兼容es6写法 vue中安装插件
		<li>npm install --save babel-polyfill</li>
	</ol>
	<ol>vue启动报错：CALL_AND_RETRY_LAST Allocation failed-process out of memory
		<ul>方式1：（亲测可用）
			<li>安装increase-memory-limit插件</li>
			<li> npm install -g increase-memory-limit</li>
			<li>运行 increase-memory-limit</li>
			<li>在nodemodule中webpack.cmd文件生成node --max-old-space-size=10240 "%~dp0\..\webpack\bin\webpack.js" %*</li>
		</ul>
		<ul>方式2：
			<li>在package.json文件中通过手动给"build"设置 --max_old_space_size=4096 来增加内存
			<li>build:node --max_old_space_size=4096 build/build.js</li>
		</ul>

		</li>
	</ol>
	<ol>vue Element table的用法
		<li>增加index索引
			<pre><el-table-column type="index" align="center" width="50"></el-table-column></pre>
		</li>
		<li>多选：
			<pre><el-table-column type="selection" :reserve-selection="true"></el-table-column></pre>
		</li>
		<li>点击行实现复选
			<pre>
			<el-table
            	border
            	ref="multipleTable"
            	:data="inviteMemberList.list" //绑定的数据
            	style="width: 100%"
            	tooltip-effect="dark"
            	@selection-change="selectionChange" //选择发生改变时
            	@row-click="clickRow" //行点击事件  实现复选
            	:row-key="getRowKeys" //实现行点击复选必写
          ></el-table>
			</pre>
		</li>
		<li>清除所有已复选
			<pre>this.$refs.multipleTable.clearSelection()</pre>
		</li>
	</ol>
	<ol>父与子的传值
		<li>一般来说自定义出来复用的组件称为子组件，调用子组件的vue称为父组件</li>
		<li>父组件中引入子组件：
			<pre>
				ts:
				import PersonList from '../../components/PersonList'
				components: {
					PersonList
				},
				html:
				<person-list
        			@change="handlePersonListChange"
        			@cancel="cancel" //监听子组件传来的方法
        			:multipleSelectionList1="multipleSelectionList1" //传向子组件
        			:formType="formType"
        			ref="PersonList"
      			></person-list>
			</pre>
		</li>
		<li>子组件中拿到父组件传来的值
			<pre>
				props: {
					multipleSelectionList1: Array,
					formType: String
				  },
				<!-- 触发父组件@change的事件并传值给父组件 -->
				this.$emit('change', this.multipleSelectionList, this.formType)
			</pre>
		</li>
		<li>父组件调用子组件的方法：this.$refs.PersonList.cancelSelect()</li>
	</ol>
	<ol>select的用法
		<li>拿到选中的option的这条信息
			<pre>
				<el-select
					class="input-width-edit"
					placeholder="请选择检查标准"
					@focus="queryStrdandFileList('updateForm')"
					v-model="updateForm.checkStandard"
					@change="selectDoc($event)"
				  >
				  <el-option
              		v-for="item in checkStandardFileList"
              		:key="item.id"
              		:label="item.fileName"
              		:value="item.id"
            	  ></el-option>
			</pre>
			<pre>
				selectDoc ($event) {
					let obj = {}
					obj = this.checkStandardFileList.find((item) => { // 这里的userList就是上面遍历的数据源
					  return item.id === $event // 筛选出匹配数据
					})
					console.log(obj) // 我这边的name就是对应label的
					this.createForm.downloadUrl = obj.fileUrl
				},
			</pre>
		</li>
	</ol>
	<ol>MVP设计模式
		<li>M:model层 指的是数据层（即通过ajax获取的数据）</li>
		<li>V:view层 视图层 指的是通过dom渲染呈现的视图</li>
		<li>P: presenter层 呈现层 指的是业务逻辑的的控制层 </li>
		<li>流程一般为：视图层发生一个事件交给控制器，控制器去调用ajax获取数据或者直接操作dom，根据视图发生的事件，控制器自己的逻辑去决定dom怎么重新修改
			precenter层是MVP中最核心的一层，它里面放的逻辑是视图和控制之间的中转站
		</li>
	</ol>
	<ol>vue采用的是MVVM设计模式
		<li>M：model</li>
		<li>VM:ViewModel</li>
		<li>M</li>
	</ol>
	<ol>Vue版本的安装和卸载
		<li>卸载2使用 npm uninstall vue-cli -g </li>
		<li>卸载3使用 npm uninstall -g @vue/cli</li>
		<li>卸载4使用 npm uninstall -g @vue/cli</li>
		<li>安装2使用 npm install vue-cli -g</li>
	</ol>
	<ol>npm命令
		<li>npm cache clean --force</li>
	</ol>
	<ol>vue Element中table中添加expand展开行
		<li>
			<pre>
				<el-table
            		ref="multipleTable"
            		:data="constructionUnitList.list" // 绑定数据
            		style="width: 100%"
            		v-loading="tableLoading" // 显示加载中	
            		@expand-change="acquireUserId" // 点击展开行三角图标
            		:expand-row-keys="expands" // 结合row-key使用 给每一行一个唯一标识
            		:row-key="getRowKeys"
				  >
				  <el-table-column :show-overflow-tooltip="true" type="expand">
						<template slot-scope="props"> // 插入props模版
							<div>
								<el-tabs
								  v-model="props.row.activeName" // 给table每一行绑定activeName
								  @tab-click="handleClick" // 行点击事件
								>
									<el-tab-pane label="tab1" name="first"></el-tab-pane>
									<el-tab-pane label="tab2" name="second"></el-tab-pane>
								</el-tabs>	
							</div>
						</template>
				  </el-table-column>
				</el-table>
				<!-- data -->
				expands: [], // 施工记录展开行
      			getRowKeys (row) {
        			return row.id
				  },
				<!-- methods -->
				acquireUserId (row, expandedRows) {
					var that = this
					if (expandedRows.length) {
					  that.expands = []
					  if (row) {
						that.expands.push(row.id)
					  }
					} else {
					  that.expands = []
					}
					Do Something....
				},
			</pre>
		</li>
	</ol>
</body>

</html>